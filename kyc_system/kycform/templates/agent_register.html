{% load static %}
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Agent Register</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  :root {
    --green:#00c06f;
    --blue:#0a1d56;
}

  html,body{
      height:100%;
      margin:0;
      background:linear-gradient(180deg,#06b36a 0,#00a45a 100%);
      font-family:"Segoe UI";
  }

  .wrap{
      max-width:920px;
      margin:42px auto;
      background:#fff;
      border-radius:12px;
      display:flex;
      overflow:hidden;
      box-shadow:0 12px 36px rgba(0,0,0,.25);
  }

  /* ===============================
     CLEAN LEFT PANEL (ONLY THIS!)
     =============================== */
  .left {
      flex: 1;
      background: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px;
      min-height: 350px;
  }

  .logo-fill {
      width: 90%;
      height: auto;
      max-height: 280px;
      object-fit: contain;
      display: block;
  }

  @media (min-width: 992px) {
      .logo-fill {
          width: 75%;
          max-height: 320px;
      }
  }

  @media (max-width: 768px) {
      .wrap {
          flex-direction: column;
          text-align: center;
      }
      .left {
          padding: 20px;
      }
      .logo-fill {
          width: 70%;
          max-height: 200px;
      }
  }

  /* RIGHT SIDE */
  .right{
      flex:1;
      padding:36px;
  }

  .form-control{
      border-radius:8px;
      padding:.85rem;
  }

  .btn-register{
      background:var(--green);
      color:#fff;
      border:none;
      padding:12px;
      border-radius:8px;
      font-weight:700;
      width:100%;
  }

  /* POPUP */
  .popup-overlay{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background:rgba(0,0,0,.45);
      z-index:1100;
  }

  .popup{
      width:420px;
      background:#fff;
      border-radius:12px;
      padding:26px;
      text-align:center;
      box-shadow:0 12px 36px rgba(0,0,0,.28);
  }

   .header-title {
    font-size:24px;
    font-weight:700;
    color:var(--blue);
    margin-bottom:22px;
}
</style>

</head>
<body>

<div class="wrap">

  <!-- LEFT PANEL -->
  <div class="left">
      <img src="{% static 'images/rjbclogo.png' %}" class="logo-fill" alt="RJBC Logo">
  </div>

  <!-- RIGHT PANEL -->
  <div class="right">
    <div class="header-title text-center">Agent Registration</div>

    {% if messages %}
      {% for msg in messages %}
        <div class="d-none js-kyc-message" data-tags="{{ msg.tags }}" data-text="{{ msg|escapejs }}"></div>
      {% endfor %}
    {% endif %}

<form method="POST"
      action="{% url 'kyc:agent_register' %}"
      autocomplete="off">

    {% csrf_token %}

    <!-- Autofill blockers (Chrome trick) -->
    <input type="text" style="display:none" autocomplete="off">
    <input type="password" style="display:none" autocomplete="new-password">

    <div class="mb-3">
        <input name="agent_code"
               class="form-control"
               placeholder="Agent Code"
               autocomplete="off"
               required>
    </div>

    <div class="row g-2 mb-3">
        <div class="col-md-6">
            <input name="first_name"
                   class="form-control"
                   placeholder="First Name"
                   autocomplete="off"
                   required>
        </div>

        <div class="col-md-6">
            <input name="last_name"
                   class="form-control"
                   placeholder="Last Name"
                   autocomplete="off"
                   required>
        </div>
    </div>

    <div class="mb-3">
        <input name="phone_number"
               class="form-control"
               placeholder="Phone Number"
               autocomplete="off"
               required>
    </div>

    <div class="mb-3">
        <input name="email"
               type="email"
               class="form-control"
               placeholder="Email Address"
               autocomplete="new-password"
               required>
    </div>

    <button class="btn-register">Register</button>
</form>


    <p class="mt-3 text-center">
        Already have an account?
        <a href="/auth/agent/?tab=agent" style="color:#00a35a;font-weight:600;">Login</a>
    </p>
  </div>
</div>

<!-- POPUP -->
<div id="kycPopup" class="popup-overlay">
  <div class="popup">
    <div id="pIcon" style="font-size:32px;margin-bottom:10px"></div>
    <div id="pTitle" style="font-size:20px;font-weight:700;margin-bottom:6px"></div>
    <div id="pMsg" style="color:#444;margin-bottom:14px"></div>
    <button id="pOk" class="btn-register" style="width:100%;background:#00c06f;">OK</button>
  </div>
</div>

<script>
  const msgNode = document.querySelector('.js-kyc-message');
  const overlay = document.getElementById('kycPopup');
  const pIcon = document.getElementById('pIcon');
  const pTitle = document.getElementById('pTitle');
  const pMsg = document.getElementById('pMsg');
  const pOk = document.getElementById('pOk');

  function showPopup(tag, text){
    overlay.style.display = 'flex';

    if(tag.includes('success')){
        pTitle.textContent = 'Success';
        pIcon.innerHTML = '✔';
        pOk.onclick = () => window.location.href='/auth/agent/?tab=agent';
    } else {
        pTitle.textContent = 'Error';
        pIcon.innerHTML = '✖';
        pOk.onclick = () => window.location.reload();
    }

    pMsg.textContent = text;
  }

  if(msgNode){
      showPopup(msgNode.dataset.tags, msgNode.dataset.text);
  }
</script>

</body>
</html>
