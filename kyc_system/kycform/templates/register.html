{% load static %}
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Register Policy</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  :root{--green:#00c06f}
  html,body{height:100%;margin:0;font-family:"Segoe UI",sans-serif;background:linear-gradient(180deg,#06b36a 0,#00a45a 100%)}
  .wrap{max-width:920px;margin:36px auto;background:#fff;border-radius:12px;display:flex;overflow:hidden;box-shadow:0 18px 46px rgba(3,40,21,.12)}
  .left{flex:1;background-image:url("{% static 'images/background1.jpg' %}");background-size:cover;display:flex;align-items:center;justify-content:center;padding:30px}
  .left img{width:260px}
  .right{flex:1;padding:36px}
  h3{margin-top:0;color:#0a1d56}
  .form-control{border-radius:8px;padding:.85rem}
  .btn-register{background:var(--green);color:#fff;border:none;padding:12px;border-radius:8px;font-weight:700;width:100%}
  .popup-overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.45);z-index:1100}
  .popup{width:420px;background:#fff;border-radius:12px;padding:26px;text-align:center;box-shadow:0 12px 36px rgba(0,0,0,.28)}
</style>
</head>
<body>

<div class="wrap">
  <div class="left"><img src="{% static 'images/rjbclogo.png' %}" alt="logo"></div>
  <div class="right">
    <h3>Register Your Policy Number</h3>

    <!-- messages -->
    {% if messages %}
      {% for msg in messages %}
        <div class="d-none js-kyc-message" data-tags="{{ msg.tags }}" data-text="{{ msg|escapejs }}"></div>
      {% endfor %}
    {% endif %}

    <form method="POST" action="/register/">
      {% csrf_token %}
      <div class="row g-2 mb-3">
        <div class="col-md-6"><input name="first_name" class="form-control" placeholder="First Name" required></div>
        <div class="col-md-6"><input name="last_name" class="form-control" placeholder="Last Name" required></div>
      </div>

      <div class="mb-3"><input name="email" type="email" class="form-control" placeholder="Email Address" required></div>
      <div class="mb-3"><input name="mobile" class="form-control" placeholder="Mobile Number" required></div>
      <div class="mb-3"><input name="policy_number" class="form-control" placeholder="Policy Number" required></div>

      <button class="btn-register">Register</button>
    </form>

    <p class="mt-3 text-center">Already have an account? <a href="/">Login</a></p>
  </div>
</div>

<!-- popup -->
<div id="kycPopup" class="popup-overlay">
  <div class="popup">
    <div id="pIcon" style="font-size:28px;margin-bottom:8px"></div>
    <div id="pTitle" style="font-weight:700;margin-bottom:6px"></div>
    <div id="pMsg" style="color:#444;margin-bottom:14px"></div>
    <button id="pOk" style="background:var(--green);color:#fff;border:none;padding:10px;border-radius:8px;width:100%;font-weight:700">OK</button>
  </div>
</div>

<script>
  const msgNode = document.querySelector('.js-kyc-message');
  const overlay = document.getElementById('kycPopup');
  const pIcon = document.getElementById('pIcon');
  const pTitle = document.getElementById('pTitle');
  const pMsg = document.getElementById('pMsg');
  const pOk = document.getElementById('pOk');

  function showPopup(tag,text){
    overlay.style.display='flex';
    if(tag.includes('success')){ pTitle.textContent='Success'; pIcon.innerHTML='✔'; pOk.onclick = ()=> window.location.href='/'; }
    else { pTitle.textContent='Error'; pIcon.innerHTML='✖'; pOk.onclick = ()=> window.location.reload(); }
    pMsg.textContent = text;
    setTimeout(()=>pOk.click(),3000);
  }
  if(msgNode){ showPopup(msgNode.dataset.tags, msgNode.dataset.text); }
</script>

</body>
</html>
