{% load static %}
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Reset Password | RJBC</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>

  :root {
    --green:#00c06f;
    --blue:#0a1d56;
}
  body {
    background:#06b36a;
    font-family:'Segoe UI';
    padding-top:50px;
  }

  .wrap {
    max-width:1000px;
    margin:auto;
    background:white;
    border-radius:12px;
    display:flex;
    overflow:hidden;
    box-shadow:0 10px 30px rgba(0,0,0,0.15);
  }

  /* LEFT PANEL */
  .left {
      flex: 1;
      background: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px;
      min-height: 350px;
  }

  .logo-fill {
      width: 90%;
      height: auto;
      max-height: 280px;
      object-fit: contain;
      display: block;
  }

  @media (min-width: 992px) {
      .logo-fill {
          width: 75%;
          max-height: 320px;
      }
  }

  @media (max-width: 768px) {
      .wrap { flex-direction: column; text-align:center; }
      .left { padding: 20px; }
      .logo-fill { width:70%; max-height:200px; }
  }

  .right { flex:1; padding:40px 45px; }

  .btn-green {
    background:#00a45a;
    color:white;
    width:100%;
    padding:12px;
    border-radius:8px;
    border:none;
    font-size:17px;
    font-weight:600;
  }

  /* Popup */
  .popup-overlay {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.45);
      z-index: 2000;
  }

  .popup-box {
      width: 420px;
      background: white;
      border-radius: 12px;
      padding: 26px;
      text-align: center;
      box-shadow: 0 12px 36px rgba(0,0,0,0.28);
  }

   .header-title {
    font-size:24px;
    font-weight:700;
    color:var(--blue);
    margin-bottom:22px;
}

</style>

</head>
<body>

<div class="wrap">

  <!-- LEFT AREA -->
  <div class="left">
      <img src="{% static 'images/rjbclogo.png' %}" class="logo-fill" alt="RJBC Logo">
  </div>

  <!-- RIGHT AREA -->
  <div class="right">

      <div class="header-title text-center">Reset Password</div>

      {% if messages %}
        {% for m in messages %}
          <div class="d-none js-reset-msg" data-tags="{{ m.tags }}" data-text="{{ m|escapejs }}"></div>
        {% endfor %}
      {% endif %}

      <form method="POST" autocomplete="off">
    {% csrf_token %}

    <!-- Hidden values -->
    <input type="hidden" name="type" value="{{ user_type }}">
    <input type="hidden" name="identifier" value="{{ identifier }}">

    <!-- Autofill traps to prevent Chrome from inserting old saved passwords -->
    <input type="text" style="display:none" autocomplete="off">
    <input type="password" style="display:none" autocomplete="new-password">

    <label class="form-label fw-semibold">New Password</label>
    <input type="password"
           name="new_password"
           class="form-control mb-3"
           autocomplete="new-password"
           required>

    <label class="form-label fw-semibold">Confirm Password</label>
    <input type="password"
           name="confirm_password"
           class="form-control mb-4"
           autocomplete="new-password"
           required>

    <button class="btn-green mb-2">Update Password</button>

    <!-- Back to correct login -->
    {% if user_type == "agent" %}
      <a href="/auth/agent/?tab=agent"
         style="color:#00a35a;font-weight:600;"
         class="text-center d-block mt-2">Back to Login</a>
    {% else %}
      <a href="/auth/policy/?tab=policy"
         style="color:#00a35a;font-weight:600;"
         class="text-center d-block mt-2">Back to Login</a>
    {% endif %}
</form>


  </div>

</div>

<!-- POPUP -->
<div id="popup" class="popup-overlay">
  <div class="popup-box">
      <div id="popupIcon"></div>
      <div id="popupTitle" class="fw-bold mb-2"></div>
      <div id="popupMsg" class="mb-3"></div>
      <button id="popupOk" class="btn-green">OK</button>
  </div>
</div>

<script src="{% static 'js/popup.js' %}"></script>

<script>
const msgNode = document.querySelector('.js-reset-msg');

if(msgNode){
    showPopup(msgNode.dataset.tags, msgNode.dataset.text);
}
</script>

</body>
</html>
